import{_ as y,c as r,o as n,a as v,d as o,D as $,e as x,t as b,u as e,E as w,b as C,i as L,j as S,r as h,x as N,l as p,g as k,F as V,z,f as B,n as D}from"./Czqr_EBs.js";import{_ as F}from"./CjALhwT_.js";import{h as T}from"./TpeEdVKv.js";import{_ as M}from"./CeupWUZ4.js";const j="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20xmlns:v='https://vecta.io/nano'%3e%3cpath%20d='M16.757%203l-2%202H5v14h14V9.243l2-2V20a1%201%200%200%201-1%201H4a1%201%200%200%201-1-1V4a1%201%200%200%201%201-1h12.757zm3.728-.9L21.9%203.516l-9.192%209.192-1.412.003-.002-1.417L20.485%202.1z'%20fill='%233fcf8e'/%3e%3c/svg%3e",q={class:"listing-boxy"},E={class:"heading"},H={class:"listing-content"},O={class:"buttons"},P={__name:"ListingCard",props:{listing:Object},emits:["deleteClick"],setup(a,{emit:_}){const f=_,t=C();return(l,s)=>{const g=w,u=F;return n(),r("div",q,[v(g,{class:"edit-but",to:`/audio/${a.listing.name}-${a.listing.id}`},{default:$(()=>[o("h3",E,[x(b(("truncateShorterString"in l?l.truncateShorterString:e(T))(a.listing.name))+" ",1),s[1]||(s[1]=o("span",{class:"green-span"},"|",-1)),x(" $"+b(a.listing.price),1)])]),_:1},8,["to"]),o("div",H,[v(u,{src:`${e(t).public.supabase.url}/storage/v1/object/public/audios/${a.listing.audio}`},null,8,["src"]),o("div",O,[v(g,{class:"edit-but",to:`/audio/${a.listing.name}-${a.listing.id}`},{default:$(()=>[...s[2]||(s[2]=[o("img",{src:j,alt:"edit button"},null,-1)])]),_:1},8,["to"]),o("p",{class:"delete-but",onClick:s[0]||(s[0]=i=>f("deleteClick",a.listing.id))},[...s[3]||(s[3]=[o("img",{src:M,alt:"delete button"},null,-1)])])])])])}}},U=y(P,[["__scopeId","data-v-d7e102ae"]]),Y={class:"listing-box"},G={key:0,class:"listings"},I={key:1,style:{"font-size":"1.4rem",color:"orangered"}},A={key:2,class:"lds-dual-ring",style:{top:"110%"}},J={key:3,style:{"font-size":"1.5rem",color:"brown",position:"absolute",top:"11rem"}},R={__name:"index",setup(a){const _=L(),f=S(),t=h([]);N(async()=>{setTimeout(async()=>{const{data:i,error:d,refresh:m,pending:c}=await p(`/api/audio/listings/user/${_.value.id}`,"$FmO4eLaDnh");c.value||(l.value=!1),!i.value&&d.value&&(d.value=null,m()),t.value=i.value},1)});const l=h(!0);async function s(i){const{data:d}=await p(`/api/audio/${i}`,"$q61TqoGab8");await p(`/api/audio/listings/${i}`,{method:"delete"},"$ig2HmEoshY"),t.value=t.value.filter(c=>c.id!==i);const{error:m}=await f.storage.from("audios").remove([d.value.audio])}async function g(){const{data:i}=await p("/api/producerProfile/specificUser","$AMtqYLFOG1");i.value.description?t.value.length>=4?u.value="Currently we can't accept more than 4 audio listings.":D("/profile/listings/create"):u.value="You need to pick a username and fill your profile before listing an audio."}const u=h("");return(i,d)=>{const m=U;return n(),r("div",Y,[o("button",{onClick:g,class:"hero-button"}," New Listing "),!e(l)&&e(t)&&e(t).length?(n(),r("div",G,[(n(!0),r(V,null,z(e(t),c=>(n(),B(m,{key:c.id,listing:c,onDeleteClick:s},null,8,["listing"]))),128))])):!e(l)&&e(t)&&!e(t).length?(n(),r("span",I,"No audios.")):e(l)?(n(),r("div",A)):k("",!0),e(u)?(n(),r("p",J,b(e(u)),1)):k("",!0)])}}},Z=y(R,[["__scopeId","data-v-2af4f554"]]);export{Z as default};
